/**
 *  Create grades
 *
 *  @param {*} element
 */
function createGrades(element) {

    function gradesData() {
        let subjects = $('.subject');
        let data = [];

        $.each(subjects, function (i, element) {

            var elm = $(element);

            data.push({
                subject_name: elm.attr('subject-name'),
                value: elm.find('input.is-value-semester-even').val(),
                kkm: elm.find('input.is-kkm-semester-even').val(),
                semester: 'Genap',
            });

            data.push({
                subject_name: elm.attr('subject-name'),
                value: elm.find('input.is-value-semester-odd').val(),
                kkm: elm.find('input.is-kkm-semester-odd').val(),
                semester: 'Ganjil',
            });
        });

        return {
            data: data
        };
    }

    SweetModal.launch({
        swal: {
            title: "Simpan Nilai Rapor",
            text: "Ingin menyimpan nilai rapor?",
        },
        processing: {
            loadingData: {
                title: "Menyimpan nilai rapor...",
                text: "",
            },
            data: gradesData(),
            url: $('#form').attr('action'),
            after: () => {
                window.location.href = $(element).attr('redirect-to');
            }
        },
    });
}

$(document).ready(function () {

    $("body").on("click", ".btn-create-grades", function (e) {
        e.preventDefault();
        createGrades($(this));
    });

});

/**
 *  Generate chart study program applications
 *
 */
function generateChartStudyProgramApplications() {
    $.get($("#chart-study-program-applications").attr('source-url'), null,
        function (data, textStatus, jqXHR) {

            if (data.length > 0) {
                $("#chart-study-program-applications").closest(".card").toggleClass('hidden', false);

                var xAxisCategory = [];
                var totalApplicationData = [];

                data.forEach((item) => {
                    xAxisCategory.push(item.study_program_name);
                    totalApplicationData.push(item.total_applications);
                });

                var options = {
                    title: {
                        text: "Total Peserta per Program Studi"
                    },
                    chart: {
                        type: 'bar',
                        height: 300
                    },
                    series: [
                        {
                            name: 'Program Studi',
                            data: totalApplicationData
                        },
                    ],
                    plotOptions: {
                        bar: {
                            borderRadius: 4,
                            horizontal: true,
                        }
                    },
                    xaxis: {
                        categories: xAxisCategory
                    },
                    colors: ['#0067AC']
                }

                var chart = new ApexCharts(document.querySelector("#chart-study-program-applications"), options);

                chart.render();
            }

        }
    );
}

/**
 * Generate chart accepted study programs
 */
function generateChartAcceptedStudyPrograms() {
    $.get($("#chart-accepted-study-programs").attr("source-url"), null, function (
        data,
        textStatus,
        jqXHR
    ) {
        if (data.length > 0) {

            $("#chart-accepted-study-programs").closest(".card").toggleClass('hidden', false);

            var options = {
                chart: {
                    type: 'pie',
                },
                series: [],
                labels: [],
            };

            data.forEach(function (dataPoint) {
                var label = (dataPoint.type === 0) ? 'Ditolak' : 'Diterima';
                options.series.push(dataPoint.total_applications);
                options.labels.push(label);
            });

            var chart = new ApexCharts(document.querySelector("#chart-accepted-study-programs"), options);
            chart.render();
        }
    });
}




/**
 *  Document ready function
 *
 */
$(document).ready(function () {

    //  Generate charts
    generateChartStudyProgramApplications();
    generateChartAcceptedStudyPrograms();

});
